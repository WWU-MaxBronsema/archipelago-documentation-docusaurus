"use strict";(self.webpackChunkarchipelago_documentation_docsaurus=self.webpackChunkarchipelago_documentation_docsaurus||[]).push([[2264],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>h});var r=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,o=function(e,t){if(null==e)return{};var a,r,o={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,o=e.mdxType,n=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(a),m=o,h=c["".concat(s,".").concat(m)]||c[m]||d[m]||n;return a?r.createElement(h,l(l({ref:t},u),{},{components:a})):r.createElement(h,l({ref:t},u))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var n=a.length,l=new Array(n);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:o,l[1]=i;for(var p=2;p<n;p++)l[p]=a[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},3186:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>n,metadata:()=>i,toc:()=>p});var r=a(7462),o=(a(7294),a(3905));const n={title:"Managing, sheltering, pruning, and nurturing your own custom Archipelago",tags:["Github"]},l="Managing, sheltering, pruning and nurturing your own custom Archipelago",i={unversionedId:"archipelago-deployment-live-gitworkflow",id:"archipelago-deployment-live-gitworkflow",title:"Managing, sheltering, pruning, and nurturing your own custom Archipelago",description:"Now that you have your base Archipelago Live Deployment running (Do you? If not, go back!) you may be wondering about things like:",source:"@site/docs/archipelago-deployment-live-gitworkflow.md",sourceDirName:".",slug:"/archipelago-deployment-live-gitworkflow",permalink:"/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-gitworkflow",draft:!1,editUrl:"https://pr.new/github.com/WWU-MaxBronsema/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-gitworkflow.md",tags:[{label:"Github",permalink:"/archipelago-documentation-docusaurus/docs/tags/github"}],version:"current",frontMatter:{title:"Managing, sheltering, pruning, and nurturing your own custom Archipelago",tags:["Github"]},sidebar:"tutorialSidebar",previous:{title:"Adding Demo Archipelago Digital Objects (ADOs) to your Repository",permalink:"/archipelago-documentation-docusaurus/docs/archipelago-deployment-democontent"},next:{title:"Moving from archipelago-deployment to archipelago-deployment-live",permalink:"/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-moveToLive"}},s={},p=[{value:"1. Keep your Archipelago under Version Control via Github",id:"1-keep-your-archipelago-under-version-control-via-github",level:2},{value:"Basic steps",id:"basic-steps",level:3},{value:"1.1 Start by creating a Git Fork",id:"11-start-by-creating-a-git-fork",level:3},{value:"1.2 Connect your Live instance terminal.",id:"12-connect-your-live-instance-terminal",level:3},{value:"1.3 Now let&#39;s create from your current Live Instance a new Branch.",id:"13-now-lets-create-from-your-current-live-instance-a-new-branch",level:3},{value:"1.4 Push the Basics.",id:"14-push-the-basics",level:3},{value:"1.5 First Commit",id:"15-first-commit",level:3},{value:"2. Keeping your Archipelago Modules Updated during releases",id:"2-keeping-your-archipelago-modules-updated-during-releases",level:2},{value:"Which modules belong to Archipelago and follow a release cycle?",id:"which-modules-belong-to-archipelago-and-follow-a-release-cycle",level:3},{value:"3. Keeping your Archipelago&#39;s Drupal Contributed Modules and Core updated",id:"3-keeping-your-archipelagos-drupal-contributed-modules-and-core-updated",level:2},{value:"3.1 Contributed Modules.",id:"31-contributed-modules",level:3},{value:"3.1 Drupal Core inside the same major version:",id:"31-drupal-core-inside-the-same-major-version",level:3},{value:"Exact Version",id:"exact-version",level:4},{value:"Alternative Major Version",id:"alternative-major-version",level:4},{value:"3.2 Drupal Core between major versions:",id:"32-drupal-core-between-major-versions",level:3}],u={toc:p},c="wrapper";function d(e){let{components:t,...a}=e;return(0,o.kt)(c,(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"managing-sheltering-pruning-and-nurturing-your-own-custom-archipelago"},"Managing, sheltering, pruning and nurturing your own custom Archipelago"),(0,o.kt)("p",null,"Now that you have your base Archipelago Live Deployment running (Do you? If not, ",(0,o.kt)("a",{parentName:"p",href:"/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-readme"},"go back!"),") you may be wondering about things like:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What happens when I need to update to the next release?"),(0,o.kt)("li",{parentName:"ol"},"How do I keep my Drupal and Modules updated in between releases?"),(0,o.kt)("li",{parentName:"ol"},"Can I add Drupal Modules?"),(0,o.kt)("li",{parentName:"ol"},"Will a new release overwrite all my customizations?"),(0,o.kt)("li",{parentName:"ol"},"What things are safe to customize?"),(0,o.kt)("li",{parentName:"ol"},"How do I keep my very own things in Version Control and safe from others?"),(0,o.kt)("li",{parentName:"ol"},"And many (many) other similar questions.")),(0,o.kt)("h2",{id:"1-keep-your-archipelago-under-version-control-via-github"},"1. Keep your Archipelago under Version Control via Github"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Archipelagos")," are living beings. They evolve and become beautiful, closer and closer to your needs. Because of that ",(0,o.kt)("inlineCode",{parentName:"p"},"resetting")," your particularities on every ",(0,o.kt)("inlineCode",{parentName:"p"},"Archipelago")," code release is not a good idea, nor even recommended.\nWhat you want is to keep your own ",(0,o.kt)("inlineCode",{parentName:"p"},"Drupal Settings"),"\u2014your facets, your themes, your Solr fields, your own modules, and all their configurations\u2014safe and be able to restore all in case something goes wrong."),(0,o.kt)("p",null,"The ones we ship with every Release will ",(0,o.kt)("inlineCode",{parentName:"p"},"reset")," your Archipelago's settings to Factory defaults if applied ",(0,o.kt)("inlineCode",{parentName:"p"},"wildly"),"."),(0,o.kt)("p",null,"This is where ",(0,o.kt)("inlineCode",{parentName:"p"},"Github")," comes in place."),(0,o.kt)("h3",{id:"basic-steps"},"Basic steps"),(0,o.kt)("p",null,"Prerequisites:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Have an Archipelago Deployment Live instance running"),(0,o.kt)("li",{parentName:"ul"},"Have Terminal access to your Live Instance"),(0,o.kt)("li",{parentName:"ul"},"Have a Github account"),(0,o.kt)("li",{parentName:"ul"},"Have a personal Github ",(0,o.kt)("a",{parentName:"li",href:"https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token"},"Access Token Created")),(0,o.kt)("li",{parentName:"ul"},"Run ",(0,o.kt)("inlineCode",{parentName:"li"},"git config --global --edit")," on your Live Instance and Set your user name/email/etc.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Note: Opens in ",(0,o.kt)("inlineCode",{parentName:"li"},"Vi"),"! In case of emergency/panic press ",(0,o.kt)("inlineCode",{parentName:"li"},"ESC")," and type ",(0,o.kt)("inlineCode",{parentName:"li"},":x")," to escape and/or run away in terror. To edit Press ",(0,o.kt)("inlineCode",{parentName:"li"},"i")," and uncomment the lines. Once Done press ",(0,o.kt)("inlineCode",{parentName:"li"},"ESC")," and type ",(0,o.kt)("inlineCode",{parentName:"li"},":x")," to save.")))),(0,o.kt)("h3",{id:"11-start-by-creating-a-git-fork"},"1.1 Start by creating a Git Fork"),(0,o.kt)("p",null,"Let's fork ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/esmero/archipelago-deployment-live"},"https://github.com/esmero/archipelago-deployment-live")," under ",(0,o.kt)("strong",{parentName:"p"},"your own Account")," via the web.\nHappy Note: Since 2021 also keeping forked branches in sync with the origin can be done via the UI directly."),(0,o.kt)("h3",{id:"12-connect-your-live-instance-terminal"},"1.2 Connect your Live instance terminal."),(0,o.kt)("p",null,"Move to your repository's base folder, and let's start by adding your New Fork as a secondary Git ",(0,o.kt)("inlineCode",{parentName:"p"},"Origin"),".\nReplace in this command ",(0,o.kt)("inlineCode",{parentName:"p"},"yourOwnAccount")," with (guess what?) ",(0,o.kt)("strong",{parentName:"p"},"your own account"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"git remote add upstream https://github.com/yourOwnAccount/archipelago-deployment-live\n")),(0,o.kt)("p",null,"Now check if you have two remotes (",(0,o.kt)("inlineCode",{parentName:"p"},"origin")," => This repository, ",(0,o.kt)("inlineCode",{parentName:"p"},"upstream")," => your own fork):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"git remote -v\n")),(0,o.kt)("p",null,"You will see this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"origin  https://github.com/esmero/archipelago-deployment-live (fetch)\norigin  https://github.com/esmero/archipelago-deployment-live (push)\nupstream    https://github.com/yourOwnAccount/archipelago-deployment-live (fetch)\nupstream    https://github.com/yourOwnAccount/archipelago-deployment-live (push)\n")),(0,o.kt)("p",null,"Good!"),(0,o.kt)("h3",{id:"13-now-lets-create-from-your-current-live-instance-a-new-branch"},"1.3 Now let's create from your current Live Instance a new Branch."),(0,o.kt)("p",null,"We will push this branch into your Fork and it will be all yours to maintain. Please replace ",(0,o.kt)("inlineCode",{parentName:"p"},"yourOwnOrg")," with any Name you want for this. We like to keep the current Branch name in place after your personal prefix:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"git checkout -b yourOwnOrg-1.0.0-RC3\n")),(0,o.kt)("p",null,"Good, you now have a new ",(0,o.kt)("inlineCode",{parentName:"p"},"local")," branch named ",(0,o.kt)("inlineCode",{parentName:"p"},"yourOwnOrg-1.0.0-RC3"),", and it's time to decide what we are going to push into Github."),(0,o.kt)("h3",{id:"14-push-the-basics"},"1.4 Push the Basics."),(0,o.kt)("p",null,"By default our deployment strategy (this repository) ignores a few files you want to have in Github.\nAlso, there are things like the Installed Drupal Modules and PHP Libraries (the Source Code), the Database, Caches, your Secrets (",(0,o.kt)("inlineCode",{parentName:"p"},".env")," file), and your Drupal ",(0,o.kt)("inlineCode",{parentName:"p"},"settings.php")," file.\nYou ",(0,o.kt)("strong",{parentName:"p"},"FOR SURE")," do ",(0,o.kt)("strong",{parentName:"p"},"not")," want to have these in Github and are better suited for a private Backup Storage."),(0,o.kt)("p",null,"Let's start by ",(0,o.kt)("inlineCode",{parentName:"p"},"push"),"ing what you have (no commits, your new ",(0,o.kt)("inlineCode",{parentName:"p"},"yourOwnOrg-1.0.0-RC3")," as it is) to your new Fork. From there on we can add new Commits and files:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"git push upstream yourOwnOrg-1.0.0-RC3\n")),(0,o.kt)("p",null,"And Git will respond with the following (use your ",(0,o.kt)("inlineCode",{parentName:"p"},"yourOwnAccount")," personal Github Access Token as password):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"Username for 'https://github.com': yourOwnAccount\nPassword for 'https://yourOwnAccount@github.com': \nTotal 0 (delta 0), reused 0 (delta 0)\nremote: \nremote: Create a pull request for 'yourOwnOrg-1.0.0-RC3' on GitHub by visiting:\nremote:      https://github.com/yourOwnAccount/archipelago-deployment-live/pull/new/yourOwnOrg-1.0.0-RC3\nremote: \nTo https://github.com/yourOwnAccount/archipelago-deployment-live\n * [new branch]      yourOwnOrg-1.0.0-RC3 -> yourOwnOrg-1.0.0-RC3\n")),(0,o.kt)("h3",{id:"15-first-commit"},"1.5 First Commit"),(0,o.kt)("p",null,"Right now this new Branch (go and check it out at ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/yourOwnAccount/archipelago-deployment-live/tree/yourOwnOrg-1.0.0-RC3"},"https://github.com/yourOwnAccount/archipelago-deployment-live/tree/yourOwnOrg-1.0.0-RC3"),') will not differ at all from 1.0.0-RC3. That is OK. To make your Branch unique, what we want is to "commit" our changes. How do we do this?'),(0,o.kt)("p",null,"Let's add our ",(0,o.kt)("inlineCode",{parentName:"p"},"composer.json")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"composer.lock")," to our change list. Both of these files are quite personal, and as you add more Drupal Modules, dependencies, or Upgrade your Archipelgo and/or Drupal Core and Modules, all of these corresponding files will change. See the ",(0,o.kt)("inlineCode",{parentName:"p"},"-f"),'?\nBecause our base deployment ignores that file and you want it, we "Force" add it.\n',(0,o.kt)("em",{parentName:"p"},"Note: At this stage ",(0,o.kt)("inlineCode",{parentName:"em"},"composer.lock")," won't be added at all because it's still the same as before. So you can only \"add\" files that have changes.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"git add drupal/composer.json \ngit add -f drupal/composer.lock\n")),(0,o.kt)("p",null,"Now we can see what is new and will be committed by executing:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"git status\n")),(0,o.kt)("p",null,"You may see something like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'On branch yourOwnOrg-1.0.0-RC3 \nChanges to be committed:\n  (use "git restore --staged <file>..." to unstage)\n    new file:   drupal/composer.json\n\nChanges not staged for commit:\n  (use "git add <file>..." to update what will be committed)\n  (use "git restore <file>..." to discard changes in working directory)\n    modified:   drupal/scripts/archipelago/deploy.sh\n    modified:   drupal/scripts/archipelago/update_deployed.sh\n\nUntracked files:\n  (use "git add <file>..." to include in what will be committed)\n    deploy/ec2-docker/docker-compose.yml\n    drupal/.editorconfig\n    drupal/.gitattributes\n')),(0,o.kt)("p",null,"If you do not want to add each ",(0,o.kt)("inlineCode",{parentName:"p"},"Changes not staged for commit")," individually (WE recommend you only commit what you need. Be warned and take caution.), you can also issue a ",(0,o.kt)("inlineCode",{parentName:"p"},"git add ."),", which means add all."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"git add drupal/scripts/archipelago/deploy.sh\ngit add drupal/scripts/archipelago/update_deployed.sh\ngit add deploy/ec2-docker/docker-compose.yml\n")),(0,o.kt)("p",null,"In this case we are also committing ",(0,o.kt)("inlineCode",{parentName:"p"},"docker-compose.yml"),", which you may have customized and modified to your domain (See ",(0,o.kt)("a",{parentName:"p",href:"/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-readme#step-3-setup-your-enviromental-variables-for-dockerservices"},"Install Guide Step 3"),"), ",(0,o.kt)("inlineCode",{parentName:"p"},"deploy.sh")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"update_deployed.sh")," scripts.\nIf you ever need to avoid tracking certain files at all, you can edit the ",(0,o.kt)("inlineCode",{parentName:"p"},".gitignore")," file and add more patterns to it (look at it, it's fun!)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'git commit -m "Fresh Install of Archipelago for yourOwnOrg"\n')),(0,o.kt)("p",null,"If you had your email/user account setup correctly (see ",(0,o.kt)("a",{parentName:"p",href:"#basic-steps"},"Prerequisites"),") you will see:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"Fresh Install of Archipelago yourOwnOrg\n 4 files changed, 360 insertions(+), 46 deletions(-)\n create mode 100644 deploy/ec2-docker/docker-compose.yml\n create mode 100644 drupal/composer.json\n")),(0,o.kt)("p",null,"And now finally you can push this back to your Fork:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"git push upstream yourOwnOrg-1.0.0-RC3\n")),(0,o.kt)("p",null,"And Git will respond with the following (use your ",(0,o.kt)("inlineCode",{parentName:"p"},"yourOwnAccount")," personal Github Access Token as password):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"Username for 'https://github.com': yourOwnAccount\nPassword for 'https://yourOwnAccount@github.com': \nEnumerating objects: 18, done.\nCounting objects: 100% (18/18), done.\nCompressing objects: 100% (10/10), done.\nWriting objects: 100% (10/10), 2.26 KiB | 2.26 MiB/s, done.\nTotal 10 (delta 5), reused 0 (delta 0)\nremote: Resolving deltas: 100% (5/5), completed with 5 local objects.\nTo https://github.com/yourOwnAccount/archipelago-deployment-live\n   d9fa835..3427ce5  yourOwnOrg-1.0.0-RC3 -> yourOwnOrg-1.0.0-RC3\n")),(0,o.kt)("p",null,"And done."),(0,o.kt)("h2",{id:"2-keeping-your-archipelago-modules-updated-during-releases"},"2. Keeping your Archipelago Modules Updated during releases"),(0,o.kt)("p",null,'Releases in Archipelago are a bit different to other OSS projects. When a Release is done (let\'s say 1.0.0-RC2) we freeze the current release branches in every module we provide, package the release, and inmediatelly start with a new Release Cycle (6 months long normally) by creating in each repository a new Set of Branches (for this example 1.0.0-RC3). All new commits, fixes, improvements, features now will ALWAYS go into the Open/on-going new cycle branches (for this example 1.0.0-RC3), and once we are done we do it all over again. We freeze (for this example 1.0.0-RC3), and a new release cycle starts with fresh new "WIP" branches (for this example 1.1.0).'),(0,o.kt)("p",null,"Some Modules like AMI or Strawberry Runners have their independent Version but are released together anyway, e.g. for 1.0.0-RC3 both AMI and Strawberry Runners are 0.2.0. Why? Because work started later than the core Archipelago and also because they are not really CORE. So what happens with ",(0,o.kt)("inlineCode",{parentName:"p"},"main")," branches? In our project ",(0,o.kt)("inlineCode",{parentName:"p"},"main")," branches are never experimental. They are always a 1:1 with the latest stable release. So ",(0,o.kt)("inlineCode",{parentName:"p"},"main")," will contain a full commit of 1.0.0-RC2 until we freeze 1.0.0-RC3 when ",(0,o.kt)("inlineCode",{parentName:"p"},"main")," gets that code. Over and over. Nice, right?"),(0,o.kt)("h3",{id:"which-modules-belong-to-archipelago-and-follow-a-release-cycle"},"Which modules belong to Archipelago and follow a release cycle?"),(0,o.kt)("p",null,"The following modules are the ones we update on every release:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/esmero/strawberryfield"},"https://github.com/esmero/strawberryfield")," -> Composer name: ",(0,o.kt)("inlineCode",{parentName:"li"},"strawberryfield/strawberryfield")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/esmero/format_strawberryfield"},"https://github.com/esmero/format_strawberryfield")," -> Composer name: ",(0,o.kt)("inlineCode",{parentName:"li"},"strawberryfield/format_strawberryfield")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/esmero/webform_strawberryfield"},"https://github.com/esmero/webform_strawberryfield")," -> Composer name: ",(0,o.kt)("inlineCode",{parentName:"li"},"strawberryfield/webform_strawberryfield")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/esmero/ami"},"https://github.com/esmero/ami")," -> Composer name: ",(0,o.kt)("inlineCode",{parentName:"li"},"archipelago/ami")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/esmero/strawberry_runners"},"https://github.com/esmero/strawberry_runners"),"    -> Composer name: ",(0,o.kt)("inlineCode",{parentName:"li"},"strawberryfield/strawberry_runners"))),(0,o.kt)("p",null,"We also update macro modules that are meant for deployment like this ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/esmero/archipelago-deployment-live"},"Repository")," and ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/esmero/archipelago-deployment"},"https://github.com/esmero/archipelago-deployment"),"."),(0,o.kt)("p",null,'To keep your Archipelago up to date, especially once you "go custom" as described in this Documentation, the process is quite simple, e.g. to fetch latest ',(0,o.kt)("inlineCode",{parentName:"p"},"1.0.0-RC3")," updates during the ",(0,o.kt)("inlineCode",{parentName:"p"},"1.0.0-RC3")," release cycle run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "composer require strawberryfield/strawberryfield:dev-1.0.0-RC3 strawberryfield/format_strawberryfield:dev-1.0.0-RC3 strawberryfield/webform_strawberryfield:dev-1.0.0-RC3 archipelago/ami:0.2.0.x-dev strawberryfield/strawberry_runners:0.2.0.x-dev strawberryfield/strawberry_runners:0.2.0.x-dev archipelago/archipelago_subtheme:dev-1.0.0-RC3 -W"\n')),(0,o.kt)("p",null,"And then run any Database updates that may be needed:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "drush updatedb"\n')),(0,o.kt)("p",null,"This will bring all the new code and all (except if there are BUGS!) should work as expected."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Note:")," Archipelago really tries hard to be as backwards compatible as possible and rarely will you see a non-documented or non-dealt-with deprecation. "),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Note 2:")," We of course recommend always running the Stable (frozen) release, but since code is plastic and fixes will go into a WIP open branch, you should be safe enough to move all modules together."),(0,o.kt)("p",null,"You can run these commands any time you need, and while the release is open you will ",(0,o.kt)("em",{parentName:"p"},"always get")," the latest code (even if it's always the same branch). Please follow/subscribe to each Module's Github to be aware of changes/issues and improvements."),(0,o.kt)("h2",{id:"3-keeping-your-archipelagos-drupal-contributed-modules-and-core-updated"},"3. Keeping your Archipelago's Drupal Contributed Modules and Core updated"),(0,o.kt)("h3",{id:"31-contributed-modules"},"3.1 Contributed Modules."),(0,o.kt)("p",null,"To keep your Archipelago's Drupal up to date check your Drupal at ",(0,o.kt)("a",{parentName:"p",href:"https://yoursite.org/admin/modules/update"},"https://yoursite.org/admin/modules/update"),". Make sure you check mostly (yes mostly, no need to overreact) for Security Updates. Not every Drupal contributed module (project) keeps backwards compatibility, and we try to test every version we ship (as in this repository's ",(0,o.kt)("inlineCode",{parentName:"p"},"composer.lock")," files) before releasing. Once you detect a major change/requirement, visit the Project's Changelog Website, and take some time reading it. If you feel confident it's not going to break all, copy the suggested Composer command, e.g. if you visit ",(0,o.kt)("a",{parentName:"p",href:"https://www.drupal.org/project/google_api_client/releases/8.x-3.2"},"https://www.drupal.org/project/google_api_client/releases/8.x-3.2")," you will see that the update is suggested as:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"Install with Composer: $ composer require 'drupal/google_api_client:^3.2'\n")),(0,o.kt)("p",null,"Using the same module as an example, before doing any final updates, check your current running version (take note in case you need to revert):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "composer info \'drupal/google_api_client"\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Keep the version around"),"."),(0,o.kt)("p",null,"Now let's update, which means using the suggested command translated to our own Docker world like this (notice the ",(0,o.kt)("inlineCode",{parentName:"p"},"-W"),"):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "composer require \'drupal/google_api_client:^3.2 -W"\n')),(0,o.kt)("p",null,"And then run any Database updates that may be needed:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "drush updatedb"\n')),(0,o.kt)("p",null,"This will update that module. Test your website. Depending on what you update, you want to focus first on the functionality it provides, and then create/edit/delete a fictitious Digital Object to ensure it did not add any errors to your most beloved Digital Objects workflows."),(0,o.kt)("p",null,"If you see errors or you feel it's not acting as it should, you can revert by doing:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "composer require \'drupal/google_api_client:^VERSION_YOU_KEPT_AROUND -W"\n')),(0,o.kt)("p",null,"And then run any Database updates that may be needed:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "drush updatedb"\n')),(0,o.kt)("p",null,"If this happens",(0,o.kt)("strong",{parentName:"p"}," we encourage you to please")," \ud83d\udc4f share your findings with our community/slack/Github ISSUE here."),(0,o.kt)("h3",{id:"31-drupal-core-inside-the-same-major-version"},"3.1 Drupal Core inside the same major version:"),(0,o.kt)("p",null,"This is quite similar to a contributed module but normally involves at least 3 dependencies and of course larger changes."),(0,o.kt)("h4",{id:"exact-version"},"Exact Version"),(0,o.kt)("p",null,"Inside the same major version, e.g. inside Drupal 9, if you are currently running Drupal ",(0,o.kt)("inlineCode",{parentName:"p"},"9.0.1")," and you want to update to an exact latest (as I write ",(0,o.kt)("inlineCode",{parentName:"p"},"9.2.4"),"):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "composer require drupal/core:9.2.4 drupal/core-dev:9.2.4 drupal/core-composer-scaffold:9.2.4 drupal/core-project-message:9.2.4 --update-with-dependencies"\n')),(0,o.kt)("p",null,"Or under Drupal 8, if you are currently running Drupal ",(0,o.kt)("inlineCode",{parentName:"p"},"8.9.14")," and you want to update to an exact latest (as I write ",(0,o.kt)("inlineCode",{parentName:"p"},"8.9.18"),"):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "composer require drupal/core-dev:8.9.18 drupal/core:8.9.18 drupal/core-composer-scaffold:8.9.18 --update-with-dependencies"\n')),(0,o.kt)("p",null,"And then for both cases run any Database updates that may be needed:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "drush updatedb"\n')),(0,o.kt)("h4",{id:"alternative-major-version"},"Alternative Major Version"),(0,o.kt)("p",null,"If you want to only remember a ",(0,o.kt)("inlineCode",{parentName:"p"},"single command")," and want to be sure to also get all extra packages for Drupal 9, run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "composer require drupal/core-dev:^9 drupal/core:^9 drupal/core-composer-scaffold:^9 drupal/core-project-message:^9 -W"\n')),(0,o.kt)("p",null,"Or for Drupal 8:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "composer require drupal/core-dev:^8 drupal/core:^8 drupal/core-composer-scaffold:^8 drupal/core-project-message:^8 -W"\n')),(0,o.kt)("p",null,"And then for both cases run any Database updates that may be needed:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'docker exec -ti esmero-php bash -c "drush updatedb"\n')),(0,o.kt)("p",null,"This will always get you the latest ",(0,o.kt)("inlineCode",{parentName:"p"},"Drupal")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"dependencies")," allowed by your ",(0,o.kt)("inlineCode",{parentName:"p"},"composer.json"),"."),(0,o.kt)("h3",{id:"32-drupal-core-between-major-versions"},"3.2 Drupal Core between major versions:"),(0,o.kt)("p",null,"Since major versions may bring larger deprecations, contributed modules will stay behind, and the world (and your database may collapse), we ",(0,o.kt)("em",{parentName:"p"},"really")," recommend that you do some tests first (locally) or follow one of our guides. We at Archipelago will always document a larger version update. Currently, the ",(0,o.kt)("a",{parentName:"p",href:"/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-upgradeFromD8ToD9"},"Drupal 8 to Drupal 9 Update is documented in detail here"),"."),(0,o.kt)("hr",null),(0,o.kt)("p",null,"Thank you for reading! Please contact us on our ",(0,o.kt)("a",{parentName:"p",href:"https://groups.google.com/forum/#!forum/archipelago-commons"},"Archipelago Commons Google Group")," with any questions or feedback, or open an ISSUE in this ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/esmero/archipelago-deployment-live/"},"Archipelago Deployment Live Repository"),"."),(0,o.kt)("p",null,"Return to ",(0,o.kt)("a",{parentName:"p",href:"/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-readme"},"Archipelago Live Deployment"),"."))}d.isMDXComponent=!0}}]);