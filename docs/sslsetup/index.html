<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-sslsetup">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">How to Setup SSL for Docker/Archipelago | Archipelago Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wwu-maxbronsema.github.io/archipelago-documentation-docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://wwu-maxbronsema.github.io/archipelago-documentation-docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://wwu-maxbronsema.github.io/archipelago-documentation-docusaurus/docs/sslsetup"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How to Setup SSL for Docker/Archipelago | Archipelago Documentation"><meta data-rh="true" name="description" content="*Work-In-Progress Note* This documentation page is still under construction and content may change with future updates. Please use caution when implementing any instructions referenced herein, as there may be missing steps or corresponding configuration files. Thank you for your patience as we continue to update Archipelago&#x27;s documentation."><meta data-rh="true" property="og:description" content="*Work-In-Progress Note* This documentation page is still under construction and content may change with future updates. Please use caution when implementing any instructions referenced herein, as there may be missing steps or corresponding configuration files. Thank you for your patience as we continue to update Archipelago&#x27;s documentation."><link data-rh="true" rel="icon" href="/archipelago-documentation-docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wwu-maxbronsema.github.io/archipelago-documentation-docusaurus/docs/sslsetup"><link data-rh="true" rel="alternate" href="https://wwu-maxbronsema.github.io/archipelago-documentation-docusaurus/docs/sslsetup" hreflang="en"><link data-rh="true" rel="alternate" href="https://wwu-maxbronsema.github.io/archipelago-documentation-docusaurus/docs/sslsetup" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/archipelago-documentation-docusaurus/blog/rss.xml" title="Archipelago Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/archipelago-documentation-docusaurus/blog/atom.xml" title="Archipelago Documentation Atom Feed"><link rel="stylesheet" href="/archipelago-documentation-docusaurus/assets/css/styles.d03fc8fd.css">
<link rel="preload" href="/archipelago-documentation-docusaurus/assets/js/runtime~main.3a9b1af4.js" as="script">
<link rel="preload" href="/archipelago-documentation-docusaurus/assets/js/main.df94142f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/archipelago-documentation-docusaurus/"><div class="navbar__logo"><img src="/archipelago-documentation-docusaurus/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/archipelago-documentation-docusaurus/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Archipelao Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/archipelago-documentation-docusaurus/docs/AMIviaSpreadsheets">Tutorial</a><a class="navbar__item navbar__link" href="/archipelago-documentation-docusaurus/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/AMIviaSpreadsheets">Ingesting New Digital Objects and Collections using Spreadsheets or Google Sheets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/CODE_OF_CONDUCT">Archipelago - code of conduct / anti-harassment policy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/I7solrImporter">Using the Islandora 7 Solr Importer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/about">About this Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/acknowledgments">Caring &amp; Coding + Fixing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/ami_index">Archipelago Multi-Importer (AMI)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/ami_lod_rec">Using AMI&#x27;s Linked Data Reconciliation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/ami_spreadsheet_overview">Spreadsheet Formatting Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/annotations">Annotations in Archipelago</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archifilepersistencestrategy">Archipelago&#x27;s File Persistence Strategy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-democontent">Adding Demo Archipelago Digital Objects (ADOs) to your Repository</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-gitworkflow">Managing, sheltering, pruning, and nurturing your own custom Archipelago</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-moveToLive">Moving from archipelago-deployment to archipelago-deployment-live</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-readme">Archipelago-deployment-live</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-updatingContainers">Updating containers in an Archipelago-deployment-live instance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-upgradeFromD8ToD9">Archipelago-deployment-live: upgrading Drupal 8 to Drupal 9 (1.0.0-RC2 to 1.0.0-RC3)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-live-upgradeFromRC3">Archipelago-deployment-live: upgrading to 1.0.0 (1.0.0-RC3 to 1.0.0)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-osx">Installing Archipelago Drupal 9 on OSX (macOS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-readme">Archipelago-deployment for Drupal 9</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-ubuntu">Installing Archipelago Drupal 9 on Ubuntu 18.04 or 20.04</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-upgradeFromD8ToD9">Archipelago-deployment: upgrading Drupal 8 to Drupal 9 (1.0.0-RC2 to 1.0.0-RC3)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-upgradeFromRC3">Archipelago-deployment: upgrading to 1.0.0 (1.0.0-RC3 to 1.0.0)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/archipelago-deployment-windows">Installing Archipelago Drupal 9 on Ubuntu 18.04 or 20.04</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/communityshowcase">Archipelago Community</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/createdisplaymodes">Creating Display Modes for Archipelago Digital Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/customwebformelements">Archipelago Custom Webform Elements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/devops">Archipelago Software Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/documentation_about">About This Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/documentation_features">Additional Documentation Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/documentation_technical">Documentation Technical Details</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/documentation_template">Example Documentation Page Title</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/documentation_workflow">GitHub Workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/firstobject">Your First Digital Object</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/generalqa_index">General Q&amp;A</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/generalqa_minio_logging">Min.io Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/generalqa_smtp_configuration">SMTP Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/generalqa_twig_modules_configuration">Twig Modules Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/giveortake">Archipelago Contribution Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/googleapi">Configuration for Google Sheets API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/">Archipelago Commons Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/inthewild">Archipelagos in the Wild</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/metadatatwigs">Twig Templates and Archipelago</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/modifyingfileextensionsinwebform">Customizing Webforms: Modifying allowable file extensions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/ourtake">Archipelago&#x27;s Philosophy &amp; Guiding Principles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/presentations_docs">Archipelago Presentations and Documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/archipelago-documentation-docusaurus/docs/sslsetup">How to Setup SSL for Docker/Archipelago</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/strawberryfield-formatters">Strawberryfield Formatters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/strawberryfields">Strawberryfields Forever</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/tbd">Documentation Update Needed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/traditional-install">traditional-install</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/webforms">webforms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/webformsasinput">Webforms as input method for Archipelago Digital Objects (ADO)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/workingtwigs">Working with Twig in Archipelago</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/archipelago-documentation-docusaurus/docs/xdebug">Debugging PHP in Archipelago</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/archipelago-documentation-docusaurus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How to Setup SSL for Docker/Archipelago</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>How to Setup SSL for Docker/Archipelago</h1><p><em><em>Work-In-Progress Note</em> This documentation page is still under construction and content may change with future updates. Please use caution when implementing any instructions referenced herein, as there may be missing steps or corresponding configuration files. Thank you for your patience as we continue to update Archipelago&#x27;s documentation.</em></p><p>The steps found below describe one potential manual SSL configuration for Archipelago deployments. A <code>git clone</code> deployment option will be available for future releases.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual-configuration-steps-for-an-ec2-aws-server">Manual Configuration Steps for an EC2 AWS Server<a href="#manual-configuration-steps-for-an-ec2-aws-server" class="hash-link" aria-label="Direct link to Manual Configuration Steps for an EC2 AWS Server" title="Direct link to Manual Configuration Steps for an EC2 AWS Server">​</a></h3><p>This process takes less than 10 minutes of reading YML files and editing a few files (described below) to get SSL running and setup with auto-renewal.</p><ol><li><p>First, configure Certbot, following the instructions found on <a href="https://certbot.eff.org" target="_blank" rel="noopener noreferrer">https://certbot.eff.org</a>.</p></li><li><p>Inside a /persistent partition, establish the following folder structure.
<em>Note: you can keep the existing folder structure if you so choose. A benefit of the following structure is that it decouples the git clone of archipelago-deployment, which is made to be self sustainable and good for coding or smaller deployments.</em></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">```Shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ec2-user@ip-17x-xx-x-xxx persistent]$ ls -lah</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total 64K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 14 root           root  4.0K Oct  5 23:11 .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dr-xr-xr-x 19 root           root  275 Dec 15  2019 ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x  8       999  999   4096 Oct 13 20:07 db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 13 root           root  4.0K Oct  5 23:03 drupal8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x  5           8183  8183   4.0K Feb 23  2020 iiifcache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x  2 root           root  4.0K Feb 23  2020 iiifconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x  4 root           root  4.0K Oct  5 22:45 nginx_conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x  3 root           root  4.0K Feb 26  2019 solrconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x  3           8983 8983  4.0K Feb 26  2019 solrcore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To get to this point, create a git clone of archipelago deployment and then copy the content of the /persistent out of the repo folder into this structure. The original (or what is left) archipelago-deployment ends inside a drupal8 folder here.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Copy and paste the following to create a local copy of this file:</p><p>??? info &quot;docker-compose.yml&quot;</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">**Be sure to replace youremail@gmail.com with your email address.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```YAML</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> version: &#x27;3.5&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   web:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     container_name: esmero-web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     image: staticfloat/nginx-certbot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     restart: always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       CERTBOT_EMAIL: &quot;youremail@gmail.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - &quot;80:80&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - &quot;443:443&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - /persistent/nginx_conf/conf.d:/etc/nginx/user.conf.d:ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - /persistent/nginx_conf/certbot_extra_domains:/etc/nginx/certbot/extra_domains:ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - /persistent/drupal8:/var/www/html:cached</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     depends_on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - solr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     tty: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - host-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - esmero-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   php:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     container_name: esmero-php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     restart: always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     image: &quot;esmero/php-7.3-fpm:latest&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     tty: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - host-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - esmero-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - ${PWD}:/var/www/html:cached</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   solr:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     container_name: esmero-solr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     restart: always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     image: &quot;solr:7.5.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     tty: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - &quot;8983:8983&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - host-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - esmero-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - /persistent/solrcore:/opt/solr/server/solr/mycores:cached</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - /persistent/solrconfig:/drupalconfig:cached</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     entrypoint:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - docker-entrypoint.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - solr-precreate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - drupal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - /drupalconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # see https://hub.docker.com/_/mysql/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   db:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     image: mysql:5.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     command: --max_allowed_packet=256M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     container_name: esmero-db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     restart: always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       MYSQL_ROOT_PASSWORD: esmerodb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - host-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - esmero-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - /persistent/db:/var/lib/mysql:cached</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   iiif:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     container_name: esmero-cantaloupe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     image: &quot;esmero/cantaloupe-s3:4.1.6&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     restart: always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - &quot;8183:8182&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - host-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - esmero-net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - /persistent/iiifconfig:/etc/cantaloupe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - /persistent/iiifcache:/var/cache/cantaloupe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   host-net:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     driver: bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   esmero-net:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     driver: bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     internal: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Note: This file shows how the folders in Step 1 are being used, and how SSL is being automatically deployed and renewed (without any human interaction other than starting the docker-compose and watching the logs).</em></p></li><li><p>Now copy and paste the following to create a local copy of this file:</p><p>??? info &quot;ngnix.conf&quot;
**Be sure to replace all instances of yoursite.org with your own domain.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">```Shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> # goes into /persistent/nginx_conf/conf.d/nginx.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> upstream cantaloupe {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  server  esmero-cantaloupe:8182;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    listen              443 ssl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server_name         yoursite.org;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ssl_certificate     /etc/letsencrypt/live/yourstie.org/fullchain.pem;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ssl_certificate_key /etc/letsencrypt/live/yoursite.org/privkey.pem;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     client_max_body_size 512M; ## Match with PHP from FPM container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    root /var/www/html/web; ## &lt;-- Your only path reference.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fastcgi_send_timeout 120s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fastcgi_read_timeout 120s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fastcgi_pass_request_headers on;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fastcgi_buffers 16 16k;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fastcgi_buffer_size 32k;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Cantaloupe proxypass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location /cantaloupe/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       proxy_set_header X-Forwarded-Proto $scheme;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       proxy_set_header X-Forwarded-Host $host;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       proxy_set_header X-Forwarded-Port $server_port;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       proxy_set_header X-Forwarded-Path /cantaloupe/;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       if ($request_uri ~* &quot;/cantaloupe/(.*)&quot;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         proxy_pass http://cantaloupe/$1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location = /favicon.ico {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log_not_found off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        access_log off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location = /robots.txt {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        allow all;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log_not_found off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        access_log off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Very rarely should these ever be accessed outside of your lan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~* \.(txt|log)$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        deny all;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~ \..*/.*\.php$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 403;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~ ^/sites/.*/private/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 403;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Allow &quot;Well-Known URIs&quot; as per RFC 5785</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~* ^/.well-known/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        allow all;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Block access to &quot;hidden&quot; files and directories whose names begin with a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # period. This includes directories used by version control systems such</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # as Subversion or Git to store control files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~ (^|/)\. {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 403;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try_files $uri /index.php?$query_string; # For Drupal &gt;= 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location @rewrite {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rewrite ^/(.*)$ /index.php?q=$1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Don&#x27;t allow direct access to PHP files in the vendor directory.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~ /vendor/.*\.php$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        deny all;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 404;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Allow Modules to be updated via UI (still we believe composer is the way)    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rewrite ^/core/authorize.php/core/authorize.php(.*)$ /core/authorize.php$1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # In Drupal 8, we must also match new paths where the &#x27;.php&#x27; appears in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # the middle, such as update.php/selection. The rule we use is strict,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # and only allows this pattern with the update.php front controller.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # This allows legacy path aliases in the form of</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # blog/index.php/legacy-path to continue to route to Drupal nodes. If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # you do not have any paths like that, then you might prefer to use a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # laxer rule, such as:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #   location ~ \.php(/|$) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # The laxer rule will continue to work if Drupal uses this new URL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # pattern with front controllers other than update.php in a future</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # release.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~ &#x27;\.php$|^/update.php&#x27; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fastcgi_split_path_info ^(.+?\.php)(|/.*)$;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        include fastcgi_params;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # Block httpoxy attacks. See https://httpoxy.org/.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fastcgi_param HTTP_PROXY &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fastcgi_param PATH_INFO $fastcgi_path_info;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fastcgi_param PHP_VALUE &quot;upload_max_filesize=512M \n post_max_size=512M&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_read_timeout 900s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fastcgi_intercept_errors on;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fastcgi_pass esmero-php:9000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     # Fighting with Styles? This little gem is amazing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~ ^/sites/.*/files/styles/ { # For Drupal &gt;= 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try_files $uri @rewrite;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Handle private files through Drupal.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~ ^/system/files/ { # For Drupal &gt;= 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try_files $uri /index.php?$query_string;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Create the following folder:</p><div class="language-Shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/persistent/nginx_conf/conf.d/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Place the ngnix.conf file inside the <code>/conf.d/</code> folder.</p></li><li><p>Create also this other folder:</p><div class="language-Shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/persistent/nginx_conf/certbot_extra_domains/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Inside the <code>/certbot_extra_domains/</code> folder, create a text file named the same way as your domain (which can/or not contain additional subdomains but needs to exist).</p><div class="language-Shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat  /persistent/nginx_conf/certbot_extra_domains/yoursite.org</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-Shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 2 root root 4.0K Oct  5 22:46 .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 4 root root 4.0K Oct  5 22:45 ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root   48 Oct  5 22:46 yoursite.org</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Optionally, create additional subdomains if needed.</em></p><div class="language-Shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat  /persistent/nginx_conf/certbot_extra_domains/yoursite.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subdomain.yoursite.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">anothersub.yoursite.org</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Make sure you have edited the <code>docker-compose.yml</code> and <code>ngnix.conf</code> files you created to match your own information. Also make sure to also adjust the paths if you do not want the /persistent approach described in Step 1.</p></li><li><p>Run the following commands:</p><div class="language-Shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker -compose up -d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker ps</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should see this:</p><div class="language-Shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">b5a04747ee06        staticfloat/nginx-certbot    &quot;/bin/bash /scripts/…&quot;   8 days ago          Up 8 days           0.0.0.0:80-&gt;80/tcp, 0.0.0.0:443-&gt;443/tcp   esmero-web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">84afae094b57        esmero/php-7.3-fpm:latest    &quot;docker-php-entrypoi…&quot;   8 days ago          Up 8 days           9000/tcp                                   esmero-php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">13a9214acfd0        esmero/cantaloupe-s3:4.1.6   &quot;sh -c &#x27;java -Dcanta…&quot;   8 days ago          Up 8 days           0.0.0.0:8183-&gt;8182/tcp                     esmero-cantaloupe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">044dd5bc7245        mysql:5.7                    &quot;docker-entrypoint.s…&quot;   8 days ago          Up 8 days           3306/tcp, 33060/tcp                        esmero-db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">31f4f0f45acc        solr:7.5.0                   &quot;docker-entrypoint.s…&quot;   8 days ago          Up 8 days           0.0.0.0:8983-&gt;8983/tcp                     esmero-solr</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>SSL has now been configured for your Archipelago instance.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-contributed-documentation">User contributed documentation:<a href="#user-contributed-documentation" class="hash-link" aria-label="Direct link to User contributed documentation:" title="Direct link to User contributed documentation:">​</a></h3><p><em>Adding SSL to Archipelago running docker</em> by <a href="https://github.com/senyzspalding" target="_blank" rel="noopener noreferrer">Zachary Spalding</a>: <a href="https://youtu.be/rfH5TLzIRIQ" target="_blank" rel="noopener noreferrer">https://youtu.be/rfH5TLzIRIQ</a></p><hr><p>Thank you for reading! Please contact us on our <a href="https://groups.google.com/forum/#!forum/archipelago-commons" target="_blank" rel="noopener noreferrer">Archipelago Commons Google Group</a> with any questions or feedback.</p><p>Return to the <a href="/archipelago-documentation-docusaurus/docs/">Archipelago Documentation main page</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://pr.new/github.com/WWU-MaxBronsema/archipelago-documentation-docusaurus/docs/sslsetup.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/archipelago-documentation-docusaurus/docs/presentations_docs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Archipelago Presentations and Documents</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/archipelago-documentation-docusaurus/docs/strawberryfield-formatters"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Strawberryfield Formatters</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#manual-configuration-steps-for-an-ec2-aws-server" class="table-of-contents__link toc-highlight">Manual Configuration Steps for an EC2 AWS Server</a></li><li><a href="#user-contributed-documentation" class="table-of-contents__link toc-highlight">User contributed documentation:</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/archipelago-documentation-docusaurus/docs/">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/archipelago-documentation-docusaurus/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/archipelago-documentation-docusaurus/assets/js/runtime~main.3a9b1af4.js"></script>
<script src="/archipelago-documentation-docusaurus/assets/js/main.df94142f.js"></script>
</body>
</html>